<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>üîê T·∫°o m√£ 2FA Gmail | Ho·∫°t ƒë·ªông tr·ª±c ti·∫øp</title>
  <style>
    body {
      font-family: "Segoe UI", Tahoma, sans-serif;
      margin: 0;
      background: linear-gradient(to right, #1f1c2c, #928dab);
      color: #fff;
      line-height: 1.6;
    }

    header {
      padding: 2rem 1rem;
      text-align: center;
      background-color: rgba(0, 0, 0, 0.5);
      border-bottom: 1px solid rgba(255,255,255,0.1);
    }

    header h1 {
      font-size: 1.8rem;
      margin: 0;
    }

    .container {
      max-width: 600px;
      margin: auto;
      padding: 2rem;
    }

    input[type="text"] {
      width: 100%;
      padding: 0.8rem;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      margin-top: 0.5rem;
    }

    .otp-box {
      margin-top: 1.5rem;
      background: rgba(0,0,0,0.3);
      padding: 1.2rem;
      border-radius: 10px;
      font-size: 2.2rem;
      text-align: center;
      letter-spacing: 4px;
      font-weight: bold;
      color: #00ffcc;
    }

    .countdown {
      text-align: center;
      margin-top: 0.5rem;
      font-size: 1rem;
      color: #ffd700;
    }

    .note, .guide {
      font-size: 0.95rem;
      color: #eee;
      margin-top: 1rem;
    }

    footer {
      text-align: center;
      font-size: 0.85rem;
      padding: 1rem;
      color: #aaa;
      border-top: 1px solid rgba(255,255,255,0.1);
      margin-top: 2rem;
    }

    code {
      background: #333;
      padding: 0.2rem 0.4rem;
      border-radius: 4px;
      color: #00ffd5;
    }
  </style>
</head>
<body>

  <header>
    <h1>üîê T·∫°o M√£ 2FA Gmail Tr·ª±c Ti·∫øp</h1>
  </header>

  <div class="container">
    <label for="secret">üî∏ Nh·∫≠p Secret Key:</label>
    <input type="text" id="secret" placeholder="V√≠ d·ª•: JBSWY3DPEHPK3PXP" oninput="updateOTP()" />

    <div class="otp-box" id="otp">------</div>
    <div class="countdown">‚è≥ C√≤n <span id="timer">--</span> gi√¢y</div>

    <div class="note">
      M√£ s·∫Ω t·ª± c·∫≠p nh·∫≠t m·ªói 30 gi√¢y. H√£y ƒë·∫£m b·∫£o b·∫°n nh·∫≠p ƒë√∫ng <code>secret key</code> khi thi·∫øt l·∫≠p 2FA Gmail.
    </div>

    <div class="guide">
      <h3>üìò C√°ch ƒëƒÉng nh·∫≠p Gmail b·∫±ng m√£ 2FA n√†y:</h3>
      <ol>
        <li>Truy c·∫≠p <a href="https://gmail.com" target="_blank">gmail.com</a> v√† ƒëƒÉng nh·∫≠p b·∫±ng t√†i kho·∫£n Google c·ªßa b·∫°n.</li>
        <li>Sau khi nh·∫≠p ƒë√∫ng m·∫≠t kh·∫©u, Gmail s·∫Ω y√™u c·∫ßu m√£ x√°c minh 2 b∆∞·ªõc (Google Authenticator). N·∫øu kh√¥ng c√≥, ch·ªçn th·ª≠ c√°ch kh√°c v√† ch·ªçn Google Authenticator.</li>
        <li>D√°n secret key ƒë√£ l∆∞u v√†o √¥ tr√™n website n√†y.</li>
        <li>L·∫•y m√£ 6 s·ªë hi·ªán ra, nh·∫≠p v√†o √¥ x√°c minh c·ªßa Gmail.</li>
        <li>N·∫øu m√£ ƒë√∫ng v√† h·ª£p l·ªá ‚Üí ƒëƒÉng nh·∫≠p th√†nh c√¥ng!</li>
      </ol>
    </div>
  </div>

  <footer>
    ¬© 2025 by noritojin.
  </footer>

  <!-- Base32 decode -->
  <script>
    function base32tohex(base32) {
      const base32chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ234567";
      let bits = "", hex = "";
      base32 = base32.replace(/=+$/, "").toUpperCase();
      for (let i = 0; i < base32.length; i++) {
        const val = base32chars.indexOf(base32.charAt(i));
        bits += val.toString(2).padStart(5, "0");
      }
      for (let i = 0; i + 4 <= bits.length; i += 4) {
        const chunk = bits.substring(i, i + 4);
        hex += parseInt(chunk, 2).toString(16);
      }
      return hex;
    }
  </script>

  <!-- TOTP -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jsSHA/2.4.2/sha.js"></script>
  <script>
    let intervalId;

    function updateOTP() {
      const secret = document.getElementById("secret").value.replace(/\s+/g, '');
      if (!secret) {
        document.getElementById("otp").textContent = "------";
        document.getElementById("timer").textContent = "--";
        clearInterval(intervalId);
        return;
      }

      function generateOTP() {
        const key = base32tohex(secret);
        const epoch = Math.floor(Date.now() / 1000);
        const time = Math.floor(epoch / 30).toString(16).padStart(16, "0");

        const shaObj = new jsSHA("SHA-1", "HEX");
        shaObj.setHMACKey(key, "HEX");
        shaObj.update(time);
        const hmac = shaObj.getHMAC("HEX");

        const offset = parseInt(hmac.substring(hmac.length - 1), 16);
        const binary = parseInt(hmac.substr(offset * 2, 8), 16) & 0x7fffffff;
        const otp = (binary % 1000000).toString().padStart(6, "0");

        document.getElementById("otp").textContent = otp;
        document.getElementById("timer").textContent = 30 - (epoch % 30);
      }

      generateOTP();
      clearInterval(intervalId);
      intervalId = setInterval(generateOTP, 1000);
    }
  </script>

</body>
</html>
